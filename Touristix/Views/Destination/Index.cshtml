@model Tuple<Touristix.Models.DestinationModel[], IQueryable<Touristix.Models.DestinationModel>>

@{
    ViewBag.Title = "Index";
}
@Styles.Render("~/Content/css/Custom")
<h2>Index</h2>
@section scripts {
    <script type="text/javascript">
        function MouseOverImage(Image, Nom) {
            document.getElementById("Text").innerHTML = Nom;
            document.getElementById("ImageActive").style.background = Image;
        }
    </script>
}
<div id="tabs">

    <div class="outer" id="ImageActive">
    <div class="bottomleft" id="Text">
    <p>(text to appear at the bottom left of the image)</p>
    </div>
    <p class="topright">(text to appear at the top right of the image)</p>
    </div>

     <ul>
         @foreach (var p in Model.Item1)
         {
             @RenderTab(p);
         }
     </ul>
</div>
@helper RenderTab(Touristix.Models.DestinationModel tab)
{
    <img onmouseover="MouseOverImage('@tab.Image', '@tab.Nom')" src="@Html.Encode(tab.Image)" alt="@Html.Encode(tab.Nom)" /> 
}
<div id="Recherche">
    @using (Html.BeginForm("Index", "Destination", FormMethod.Get))
    {
        <p> Nom: @Html.TextBox("DestinationNom") <br />
        
        Pays: @Html.TextBox("DestinationPays") <br />
        
        Région: @Html.TextBox("DestinationRegion") <br />
        
        <input type="submit" value="Filtrer" /></p>
        
    <div id="Trier">
        @Html.RadioButton("Trier", 0, new { onchange = "this.form.submit();", @checked = "checked" }) Trier par pays
        @Html.RadioButton("Trier", 1, new { onchange = "this.form.submit();" }) Trier par régions
        @Html.RadioButton("Trier", 2, new { onchange = "this.form.submit();" }) Trier par villes
    </div>
    }
</div>

<div id="Liste Destination">
@{
    IQueryable<IGrouping<string, Touristix.Models.DestinationModel>> DestinationRecu = null;
    string ValeurTriger = Request.QueryString["Trier"];
    
    if (ValeurTriger == "0" || ValeurTriger == null)
    {
        DestinationRecu = Model.Item2.GroupBy(item => item.Pays);
    }
    else if (ValeurTriger == "1")
    {
        DestinationRecu = Model.Item2.GroupBy(item => item.Region);
    }
    else if (ValeurTriger == "2")
    {
        DestinationRecu = Model.Item2.GroupBy(item => item.Ville);
    }
    
    foreach (var group in DestinationRecu)
    {
        @Html.Encode(group.Key)
        <ul>
        @foreach (var item in group)
        {
            <li>@Html.ActionLink(@Html.Encode(item.Nom), "Information", new { id = item.ID })</li>  
        }
        </ul>
    }
}

</div>
